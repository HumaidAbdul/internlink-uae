{"ast":null,"code":"// src/lib/api.js\nimport axios from'axios';const api=axios.create({baseURL:process.env.REACT_APP_API_BASE||'http://localhost:5001',timeout:15000// withCredentials: true, // <-- enable if your API uses cookies\n});// after creating the axios instance\napi.interceptors.request.use(cfg=>{const tok=sessionStorage.getItem('token')||localStorage.getItem('token');if(tok){cfg.headers=cfg.headers||{};cfg.headers.Authorization=\"Bearer \".concat(tok);}// important for uploads:\nif(cfg.data instanceof FormData){if(cfg.headers){delete cfg.headers['Content-Type'];delete cfg.headers['content-type'];}}return cfg;});// 401 handling\napi.interceptors.response.use(res=>res,err=>{var _err$response,_err$config,_err$config$headers;const status=err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status;const hadAuth=!!(err!==null&&err!==void 0&&(_err$config=err.config)!==null&&_err$config!==void 0&&(_err$config$headers=_err$config.headers)!==null&&_err$config$headers!==void 0&&_err$config$headers.Authorization);if(status===401&&hadAuth){try{sessionStorage.removeItem('session_expiry');sessionStorage.removeItem('user');sessionStorage.removeItem('token');localStorage.removeItem('user');localStorage.removeItem('token');}catch(_unused){}// optionally redirect to login here\n}return Promise.reject(err);});export default api;","map":{"version":3,"names":["axios","api","create","baseURL","process","env","REACT_APP_API_BASE","timeout","interceptors","request","use","cfg","tok","sessionStorage","getItem","localStorage","headers","Authorization","concat","data","FormData","response","res","err","_err$response","_err$config","_err$config$headers","status","hadAuth","config","removeItem","_unused","Promise","reject"],"sources":["C:/Users/humai/Downloads/internlink-uaeA/internlink-uae/frontend/src/lib/api.js"],"sourcesContent":["// src/lib/api.js\r\nimport axios from 'axios';\r\n\r\nconst api = axios.create({\r\n  baseURL: process.env.REACT_APP_API_BASE || 'http://localhost:5001',\r\n  timeout: 15000,\r\n  // withCredentials: true, // <-- enable if your API uses cookies\r\n});\r\n\r\n// after creating the axios instance\r\napi.interceptors.request.use((cfg) => {\r\n  const tok = sessionStorage.getItem('token') || localStorage.getItem('token');\r\n  if (tok) {\r\n    cfg.headers = cfg.headers || {};\r\n    cfg.headers.Authorization = `Bearer ${tok}`;\r\n  }\r\n\r\n  // important for uploads:\r\n  if (cfg.data instanceof FormData) {\r\n    if (cfg.headers) {\r\n      delete cfg.headers['Content-Type'];\r\n      delete cfg.headers['content-type'];\r\n    }\r\n  }\r\n  return cfg;\r\n});\r\n\r\n\r\n// 401 handling\r\napi.interceptors.response.use(\r\n  (res) => res,\r\n  (err) => {\r\n    const status = err?.response?.status;\r\n    const hadAuth = !!err?.config?.headers?.Authorization;\r\n\r\n    if (status === 401 && hadAuth) {\r\n      try {\r\n        sessionStorage.removeItem('session_expiry');\r\n        sessionStorage.removeItem('user');\r\n        sessionStorage.removeItem('token');\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('token');\r\n      } catch {}\r\n      // optionally redirect to login here\r\n    }\r\n    return Promise.reject(err);\r\n  }\r\n);\r\n\r\nexport default api;\r\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB,KAAM,CAAAC,GAAG,CAAGD,KAAK,CAACE,MAAM,CAAC,CACvBC,OAAO,CAAEC,OAAO,CAACC,GAAG,CAACC,kBAAkB,EAAI,uBAAuB,CAClEC,OAAO,CAAE,KACT;AACF,CAAC,CAAC,CAEF;AACAN,GAAG,CAACO,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,GAAG,EAAK,CACpC,KAAM,CAAAC,GAAG,CAAGC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC,EAAIC,YAAY,CAACD,OAAO,CAAC,OAAO,CAAC,CAC5E,GAAIF,GAAG,CAAE,CACPD,GAAG,CAACK,OAAO,CAAGL,GAAG,CAACK,OAAO,EAAI,CAAC,CAAC,CAC/BL,GAAG,CAACK,OAAO,CAACC,aAAa,WAAAC,MAAA,CAAaN,GAAG,CAAE,CAC7C,CAEA;AACA,GAAID,GAAG,CAACQ,IAAI,WAAY,CAAAC,QAAQ,CAAE,CAChC,GAAIT,GAAG,CAACK,OAAO,CAAE,CACf,MAAO,CAAAL,GAAG,CAACK,OAAO,CAAC,cAAc,CAAC,CAClC,MAAO,CAAAL,GAAG,CAACK,OAAO,CAAC,cAAc,CAAC,CACpC,CACF,CACA,MAAO,CAAAL,GAAG,CACZ,CAAC,CAAC,CAGF;AACAV,GAAG,CAACO,YAAY,CAACa,QAAQ,CAACX,GAAG,CAC1BY,GAAG,EAAKA,GAAG,CACXC,GAAG,EAAK,KAAAC,aAAA,CAAAC,WAAA,CAAAC,mBAAA,CACP,KAAM,CAAAC,MAAM,CAAGJ,GAAG,SAAHA,GAAG,kBAAAC,aAAA,CAAHD,GAAG,CAAEF,QAAQ,UAAAG,aAAA,iBAAbA,aAAA,CAAeG,MAAM,CACpC,KAAM,CAAAC,OAAO,CAAG,CAAC,EAACL,GAAG,SAAHA,GAAG,YAAAE,WAAA,CAAHF,GAAG,CAAEM,MAAM,UAAAJ,WAAA,YAAAC,mBAAA,CAAXD,WAAA,CAAaT,OAAO,UAAAU,mBAAA,WAApBA,mBAAA,CAAsBT,aAAa,EAErD,GAAIU,MAAM,GAAK,GAAG,EAAIC,OAAO,CAAE,CAC7B,GAAI,CACFf,cAAc,CAACiB,UAAU,CAAC,gBAAgB,CAAC,CAC3CjB,cAAc,CAACiB,UAAU,CAAC,MAAM,CAAC,CACjCjB,cAAc,CAACiB,UAAU,CAAC,OAAO,CAAC,CAClCf,YAAY,CAACe,UAAU,CAAC,MAAM,CAAC,CAC/Bf,YAAY,CAACe,UAAU,CAAC,OAAO,CAAC,CAClC,CAAE,MAAAC,OAAA,CAAM,CAAC,CACT;AACF,CACA,MAAO,CAAAC,OAAO,CAACC,MAAM,CAACV,GAAG,CAAC,CAC5B,CACF,CAAC,CAED,cAAe,CAAAtB,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}