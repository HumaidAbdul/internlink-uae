{"ast":null,"code":"import React from'react';import{Navigate,Outlet,useLocation}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";const getUser=()=>{try{return JSON.parse(sessionStorage.getItem('user'))||JSON.parse(localStorage.getItem('user'))||null;}catch(_unused){return null;}};const getToken=()=>sessionStorage.getItem('token')||localStorage.getItem('token');export default function RequireAuth(_ref){let{roles}=_ref;const location=useLocation();const token=getToken();const user=getUser();// مو مسجّل دخول\nif(!token||!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true,state:{from:location}});}// نطبّع قيمة الـ role إلى lowercase\nconst userRole=(user.role||'').toLowerCase();const allowedRoles=roles?roles.map(r=>r.toLowerCase()):null;// ما عنده صلاحية للراوت\nif(allowedRoles&&!allowedRoles.includes(userRole)){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}return/*#__PURE__*/_jsx(Outlet,{context:{me:user}});}","map":{"version":3,"names":["React","Navigate","Outlet","useLocation","jsx","_jsx","getUser","JSON","parse","sessionStorage","getItem","localStorage","_unused","getToken","RequireAuth","_ref","roles","location","token","user","to","replace","state","from","userRole","role","toLowerCase","allowedRoles","map","r","includes","context","me"],"sources":["C:/Users/humai/Downloads/internlink-uaeA/internlink-uae/frontend/src/components/RequireAuth.jsx"],"sourcesContent":["import React from 'react';\r\nimport { Navigate, Outlet, useLocation } from 'react-router-dom';\r\n\r\nconst getUser = () => {\r\n  try {\r\n    return (\r\n      JSON.parse(sessionStorage.getItem('user')) ||\r\n      JSON.parse(localStorage.getItem('user')) ||\r\n      null\r\n    );\r\n  } catch {\r\n    return null;\r\n  }\r\n};\r\n\r\nconst getToken = () =>\r\n  sessionStorage.getItem('token') || localStorage.getItem('token');\r\n\r\nexport default function RequireAuth({ roles }) {\r\n  const location = useLocation();\r\n  const token = getToken();\r\n  const user = getUser();\r\n\r\n  // مو مسجّل دخول\r\n  if (!token || !user) {\r\n    return <Navigate to=\"/login\" replace state={{ from: location }} />;\r\n  }\r\n\r\n  // نطبّع قيمة الـ role إلى lowercase\r\n  const userRole = (user.role || '').toLowerCase();\r\n  const allowedRoles = roles ? roles.map((r) => r.toLowerCase()) : null;\r\n\r\n  // ما عنده صلاحية للراوت\r\n  if (allowedRoles && !allowedRoles.includes(userRole)) {\r\n    return <Navigate to=\"/login\" replace />;\r\n  }\r\n\r\n  return <Outlet context={{ me: user }} />;\r\n}\r\n\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,CAAEC,MAAM,CAAEC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEjE,KAAM,CAAAC,OAAO,CAAGA,CAAA,GAAM,CACpB,GAAI,CACF,MACE,CAAAC,IAAI,CAACC,KAAK,CAACC,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,EAC1CH,IAAI,CAACC,KAAK,CAACG,YAAY,CAACD,OAAO,CAAC,MAAM,CAAC,CAAC,EACxC,IAAI,CAER,CAAE,MAAAE,OAAA,CAAM,CACN,MAAO,KAAI,CACb,CACF,CAAC,CAED,KAAM,CAAAC,QAAQ,CAAGA,CAAA,GACfJ,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC,EAAIC,YAAY,CAACD,OAAO,CAAC,OAAO,CAAC,CAElE,cAAe,SAAS,CAAAI,WAAWA,CAAAC,IAAA,CAAY,IAAX,CAAEC,KAAM,CAAC,CAAAD,IAAA,CAC3C,KAAM,CAAAE,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAe,KAAK,CAAGL,QAAQ,CAAC,CAAC,CACxB,KAAM,CAAAM,IAAI,CAAGb,OAAO,CAAC,CAAC,CAEtB;AACA,GAAI,CAACY,KAAK,EAAI,CAACC,IAAI,CAAE,CACnB,mBAAOd,IAAA,CAACJ,QAAQ,EAACmB,EAAE,CAAC,QAAQ,CAACC,OAAO,MAACC,KAAK,CAAE,CAAEC,IAAI,CAAEN,QAAS,CAAE,CAAE,CAAC,CACpE,CAEA;AACA,KAAM,CAAAO,QAAQ,CAAG,CAACL,IAAI,CAACM,IAAI,EAAI,EAAE,EAAEC,WAAW,CAAC,CAAC,CAChD,KAAM,CAAAC,YAAY,CAAGX,KAAK,CAAGA,KAAK,CAACY,GAAG,CAAEC,CAAC,EAAKA,CAAC,CAACH,WAAW,CAAC,CAAC,CAAC,CAAG,IAAI,CAErE;AACA,GAAIC,YAAY,EAAI,CAACA,YAAY,CAACG,QAAQ,CAACN,QAAQ,CAAC,CAAE,CACpD,mBAAOnB,IAAA,CAACJ,QAAQ,EAACmB,EAAE,CAAC,QAAQ,CAACC,OAAO,MAAE,CAAC,CACzC,CAEA,mBAAOhB,IAAA,CAACH,MAAM,EAAC6B,OAAO,CAAE,CAAEC,EAAE,CAAEb,IAAK,CAAE,CAAE,CAAC,CAC1C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}