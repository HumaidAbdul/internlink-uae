{"ast":null,"code":"// src/lib/api.js\nimport axios from 'axios';\nconst api = axios.create({\n  baseURL: process.env.REACT_APP_API_BASE_URL || \"http://localhost:5001/api\",\n  withCredentials: true\n});\n\n// after creating the axios instance\napi.interceptors.request.use(cfg => {\n  const tok = sessionStorage.getItem('token') || localStorage.getItem('token');\n  if (tok) {\n    cfg.headers = cfg.headers || {};\n    cfg.headers.Authorization = `Bearer ${tok}`;\n  }\n\n  // important for uploads:\n  if (cfg.data instanceof FormData) {\n    if (cfg.headers) {\n      delete cfg.headers['Content-Type'];\n      delete cfg.headers['content-type'];\n    }\n  }\n  return cfg;\n});\n\n// 401 handling\napi.interceptors.response.use(res => res, err => {\n  var _err$response, _err$config, _err$config$headers;\n  const status = err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status;\n  const hadAuth = !!(err !== null && err !== void 0 && (_err$config = err.config) !== null && _err$config !== void 0 && (_err$config$headers = _err$config.headers) !== null && _err$config$headers !== void 0 && _err$config$headers.Authorization);\n  if (status === 401 && hadAuth) {\n    try {\n      sessionStorage.removeItem('session_expiry');\n      sessionStorage.removeItem('user');\n      sessionStorage.removeItem('token');\n      localStorage.removeItem('user');\n      localStorage.removeItem('token');\n    } catch {}\n    // optionally redirect to login here\n  }\n  return Promise.reject(err);\n});\nexport default api;","map":{"version":3,"names":["axios","api","create","baseURL","process","env","REACT_APP_API_BASE_URL","withCredentials","interceptors","request","use","cfg","tok","sessionStorage","getItem","localStorage","headers","Authorization","data","FormData","response","res","err","_err$response","_err$config","_err$config$headers","status","hadAuth","config","removeItem","Promise","reject"],"sources":["C:/Users/humai/Downloads/internlink-uaeA/internlink-uae/frontend/src/lib/api.js"],"sourcesContent":["// src/lib/api.js\r\nimport axios from 'axios';\r\n\r\n\r\nconst api = axios.create({\r\n  baseURL: process.env.REACT_APP_API_BASE_URL || \"http://localhost:5001/api\",\r\n  withCredentials: true,\r\n});\r\n\r\n// after creating the axios instance\r\napi.interceptors.request.use((cfg) => {\r\n  const tok = sessionStorage.getItem('token') || localStorage.getItem('token');\r\n  if (tok) {\r\n    cfg.headers = cfg.headers || {};\r\n    cfg.headers.Authorization = `Bearer ${tok}`;\r\n  }\r\n\r\n  // important for uploads:\r\n  if (cfg.data instanceof FormData) {\r\n    if (cfg.headers) {\r\n      delete cfg.headers['Content-Type'];\r\n      delete cfg.headers['content-type'];\r\n    }\r\n  }\r\n  return cfg;\r\n});\r\n\r\n\r\n// 401 handling\r\napi.interceptors.response.use(\r\n  (res) => res,\r\n  (err) => {\r\n    const status = err?.response?.status;\r\n    const hadAuth = !!err?.config?.headers?.Authorization;\r\n\r\n    if (status === 401 && hadAuth) {\r\n      try {\r\n        sessionStorage.removeItem('session_expiry');\r\n        sessionStorage.removeItem('user');\r\n        sessionStorage.removeItem('token');\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('token');\r\n      } catch {}\r\n      // optionally redirect to login here\r\n    }\r\n    return Promise.reject(err);\r\n  }\r\n);\r\n\r\nexport default api;\r\n"],"mappings":"AAAA;AACA,OAAOA,KAAK,MAAM,OAAO;AAGzB,MAAMC,GAAG,GAAGD,KAAK,CAACE,MAAM,CAAC;EACvBC,OAAO,EAAEC,OAAO,CAACC,GAAG,CAACC,sBAAsB,IAAI,2BAA2B;EAC1EC,eAAe,EAAE;AACnB,CAAC,CAAC;;AAEF;AACAN,GAAG,CAACO,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,GAAG,IAAK;EACpC,MAAMC,GAAG,GAAGC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC,IAAIC,YAAY,CAACD,OAAO,CAAC,OAAO,CAAC;EAC5E,IAAIF,GAAG,EAAE;IACPD,GAAG,CAACK,OAAO,GAAGL,GAAG,CAACK,OAAO,IAAI,CAAC,CAAC;IAC/BL,GAAG,CAACK,OAAO,CAACC,aAAa,GAAG,UAAUL,GAAG,EAAE;EAC7C;;EAEA;EACA,IAAID,GAAG,CAACO,IAAI,YAAYC,QAAQ,EAAE;IAChC,IAAIR,GAAG,CAACK,OAAO,EAAE;MACf,OAAOL,GAAG,CAACK,OAAO,CAAC,cAAc,CAAC;MAClC,OAAOL,GAAG,CAACK,OAAO,CAAC,cAAc,CAAC;IACpC;EACF;EACA,OAAOL,GAAG;AACZ,CAAC,CAAC;;AAGF;AACAV,GAAG,CAACO,YAAY,CAACY,QAAQ,CAACV,GAAG,CAC1BW,GAAG,IAAKA,GAAG,EACXC,GAAG,IAAK;EAAA,IAAAC,aAAA,EAAAC,WAAA,EAAAC,mBAAA;EACP,MAAMC,MAAM,GAAGJ,GAAG,aAAHA,GAAG,wBAAAC,aAAA,GAAHD,GAAG,CAAEF,QAAQ,cAAAG,aAAA,uBAAbA,aAAA,CAAeG,MAAM;EACpC,MAAMC,OAAO,GAAG,CAAC,EAACL,GAAG,aAAHA,GAAG,gBAAAE,WAAA,GAAHF,GAAG,CAAEM,MAAM,cAAAJ,WAAA,gBAAAC,mBAAA,GAAXD,WAAA,CAAaR,OAAO,cAAAS,mBAAA,eAApBA,mBAAA,CAAsBR,aAAa;EAErD,IAAIS,MAAM,KAAK,GAAG,IAAIC,OAAO,EAAE;IAC7B,IAAI;MACFd,cAAc,CAACgB,UAAU,CAAC,gBAAgB,CAAC;MAC3ChB,cAAc,CAACgB,UAAU,CAAC,MAAM,CAAC;MACjChB,cAAc,CAACgB,UAAU,CAAC,OAAO,CAAC;MAClCd,YAAY,CAACc,UAAU,CAAC,MAAM,CAAC;MAC/Bd,YAAY,CAACc,UAAU,CAAC,OAAO,CAAC;IAClC,CAAC,CAAC,MAAM,CAAC;IACT;EACF;EACA,OAAOC,OAAO,CAACC,MAAM,CAACT,GAAG,CAAC;AAC5B,CACF,CAAC;AAED,eAAerB,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}